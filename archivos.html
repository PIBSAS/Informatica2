<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title>Archivos</title>
  <meta name="author" content="Ing. Osvaldo M. Pini"/>
  <meta name="created" content="2003-09-03T23:16:14.932000000"/>
  <meta name="changedby" content="Ing. Osvaldo M. Pini"/>
  <meta name="changed" content="2009-10-21T10:57:32.750000000"/>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/prism.css">
</head>

<body>
<h1>ARCHIVOS</h1>

<h2>STREAMS</h2>

<p>Un stream es un buffer de almacenamiento de los datos que se envían o reciben en una operación de entrada o salida. </p>
<p>En formato binario no se produce ningún tipo de transformación de los datos </p>
<p>En el formato de texto se producen conversiones de los valores de los datos al formato ASCII. </p>
<p>Cuando sucede que el buffer se lleno se envía el contenido de este al dispositivo de salida. </p>



<p>En el caso de una operación de entrada se toman los datos hasta que se vacíe para realizar un nuevo ingreso de datos desde el dispositivo.</p>
<p>Este sistema de procesamiento de datos tiene la característica que cuando se produce un fin anormal del programa se pierden los datos almacenados en el flujo.</p>

<!--<p>Este almacenamiento se realiza tanto para manejar datos en formato binario o de texto. </p>
-->
<h2>STREAMS STANDARD</h2>
<p>Existen 5 streams standars que se abren al iniciar un programa en C</p>
<div class="tablecontainer">
<table>
  <tr>
    <th>stdin</th>
    <td>Teclado</td>
  </tr>
  <tr>
    <th>stdout</th>
    <td>Pantalla</td>
  </tr>
  <tr>
    <th>stderr</th>
    <td>Pantalla</td>
  </tr>
  <tr>
    <th>stdprn</th>
    <td>Impresora LPT1</td>
  </tr>
  <tr>
    <th>stdaux</th>
    <td>Puerto serie 1 COM1</td>
  </tr>
</table>
</div>


<h2>APERTURA DE ARCHIVOS</h2>

<pre class="line-numbers"><code class="language-c">
FILE *fopen(char *nombre,char *modo)
</code></pre>
<p><b>nombre:</b> nombre, unidad y ruta del archivo</p>
<p><b>modo:</b> forma de apertura del archivo.</p>
<p>Devuelve un puntero a FILE si es exitoso, si error devuelve NULL.</p>

<div class="tablecontainer">
<table>
  <tr>
    <th>ATRIBUTO</th>
    <th>SIGNIFICADO</th>
  </tr>
  <tr>
    <td>r ó rt</td>
    <td>Abre un archivo de texto para lectura. Si no existe producirá un error.</td>
  </tr>
  <tr>
    <td>w ó wt</td>
    <td>Crea un archivo de texto para escritura. En el caso de que exista destruye el contenido.</td>
  </tr>
  <tr>
    <td>a ó at</td>
    <td>Abre un archivo de texto para añadir. Si no existe crea uno, si existe agrega los datos al final.</td>
  </tr>
  <tr>
    <td>rb</td>
    <td>Abre un archivo binario para lectura. Si no existe producirá un error.</td>
  </tr>
  <tr>
    <td>wb</td>
    <td>Crea un archivo binario para escritura. En el caso de que exista destruye el contenido.</td>
  </tr>
  <tr>
    <td>ab</td>
    <td>Abre un archivo binario para añadir. Si no existe crea uno, si existe agrega los datos al final.</td>
  </tr>
  <tr>
    <td>r+ o r+t</td>
    <td>Abre un archivo de texto para lectura/escritura. Si no existe no lo crea.</td>
  </tr>
  <tr>
    <td>w+ o w+t</td>
    <td>Crea un archivo de texto para lectura/escritura. Si existe destruye los contenidos del archivo existente.</td>
  </tr>
  <tr>
    <td>a+ o a+t</td>
    <td>Abre o crea un archivo de texto para lectura/escritura.</td>
  </tr>
  <tr>
    <td>r+b</td>
    <td>Abre un archivo binario para lectura/escritura. Si no existe no lo crea.</td>
  </tr>
  <tr>
    <td>w+b</td>
    <td>Crea un archivo binario para lectura/escritura. Si existe destruye los contenidos del archivo existente.</td>
  </tr>
  <tr>
    <td>a+b</td>
    <td>Abre o crea un archivo binario para lectura/escritura.</td>
  </tr>
</table>
</div>

<h2>CIERRE DE ARCHIVO</h2>

<pre class="line-numbers"><code class="language-c">int fclose(FILE *fp)</code></pre>

<p><b>fp:</b> puntero asociado al archivo</p>

<p>Devuelve 0 si se ejecuta correctamente, si ocurre un error EOF.</p>

<h2>ESCRITURA/LECTURA DE UN CARÁCTER</h2>

<div class="tablecontainer">
<table>
    <tr>
        <th><pre class="line-numbers"><code class="language-c">int fgetc(FILE *fp)</code></pre></th>
        <th><pre class="line-numbers"><code class="language-c">int fputc(int ch,FILE *fp)</code></pre></th>
    </tr>
    <tr>
        <td><p><b>fp:</b> archivo asociado</p></td>
        <td><p><b>ch:</b> carácter a escribir</p></td>
    </tr>
    <tr>
        <td> </td>
        <td><p><b>fp:</b> archivo asociado</p></td>
    </tr>
    <tr>
        <td><p><b>fgetc</b> devuelve el carácter si exitosa, <b>EOF</b> si error</p></td>
        <td><p><b>fputc</b> devuelve el carácter si exitosa, <b>EOF</b> si error</p></td>
    </tr>
</table>
</div>


<h2>DETECCION DE EOF Y ERROR</h2>

<div class="tablecontainer">
<table>
    <tr>
        <th><pre class="line-numbers"><code class="language-c">int feof(FILE *fp)</code></pre></th>
        <th><pre class="line-numbers"><code class="language-c">int ferror(FILE *fp)</code></pre></th>
    </tr>
    <tr>
        <td><p><b>fp:</b> archivo asociado</p></td>
        <td><p><b>fp:</b> archivo asociado</p></td>
    </tr>
    <tr>
        <td><p>Devuelve distinto de 0 si EOF, en caso contrario 0</p></td>
        <td><p>Devuelve 0 si no hubo error, si hubo un error distinto de 0</p></td>
    </tr>
    <tr>
        <td><p><b>fgetc</b> devuelve el carácter si exitosa, <b>EOF</b> si error</p></td>
        <td><p><b>fputc</b> devuelve el carácter si exitosa, <b>EOF</b> si error</p></td>
    </tr>
</table>
</div>


<h2>LECTURA/ESCRITURA DE STRING</h2>

<pre class="line-numbers"><code class="language-c">int fputs(char *str,FILE * fp)</code></pre>
<p><b>fp:</b> archivo asociado</p>
<p><b>str:</b> string en donde se ubica la cadena a escribir.</p>
<p><b>fputs</b> devuelve <b>EOF</b> si error, en caso contrario distinto de 0</p>

<pre class="line-numbers"><code class="language-c">char *fgets(char *str,int num, FILE *fp)</code></pre>
<p><b>fp:</b> archivo asociado</p>
<p><b>num:</b> cantidad de caracteres a leer, hasta <b>'\n'</b> o <b>EOF</b></p>
<p><b>str:</b> string en donde se ubica la cadena a leer.</p>
<p><b>fgets</b> devuelve <b>str</b> si es correcta, en caso contrario <b>NULL</b></p>

<h2>ENTRADA Y SALIDA CON FORMATO</h2>
<pre class="line-numbers"><code class="language-c">int fprintf(FILE *fp, char *control, ………………);</code></pre>
<p><b>fp:</b> archivo asociado</p>
<p><b>control:</b> cadena de control</p>
<p><b>………………….:</b> lista de variables</p>
<p>Devuelve la cantidad de ítems escritos, si hubo error <b>EOF</b></p>

<pre class="line-numbers"><code class="language-c">int fscanf(FILE *fp, char *control, ………………);</code></pre>
<p><b>fp:</b> archivo asociado</p>
<p><b>control:</b> cadena de control</p>
<p><b>………………….:</b> lista de variables</p>
<p>Devuelve la cantidad de ítems leidos, si hubo error <b>EOF</b></p>



<h2>LECTURA/ESCRITURA DE BLOQUES</h2>

<pre class="line-numbers"><code class="language-c">size_t fwrite(void *buf, size_t size, size_t n, FILE *fp);</code></pre>
<p>Escribe un bloque</p>

<pre class="line-numbers"><code class="language-c">size_t fread(void * buf, size_t size, size_t n, FILE * fp);</code></pre>
<p>Lee un bloque</p>

<p><b>buf:</b> puntero al bloque</p>
<p><b>size:</b> tamaño del bloque</p>
<p><b>n:</b> cantidad de bloques</p>
<p><b>fp: archivo asociado</b></p>
<p><b>size_t:</b> unsigned int</p>
<p>Devuelve la cantidad de bloques, si hubo error un numero &lt; n</p>



<h2>DESPLAZAMIENTO</h2>

<pre class="line-numbers"><code class="language-c">int fseek(FILE *fp, long d, int origen);</code></pre>
<p><b>fp:</b> archivo asociado</p>
<p><b>d:</b> desplazamiento</p>
<p><b>origen:</b> posición de inicio del desplazamiento</p>
<p>Devuelve 0 si no hubo error, si hubo error distinto de cero</p>

<div class="tablecontainer">
<table>
    <tr>
        <th>SEEK_SET</th>
        <td>Comienzo del archivo</td>
    </tr>
    <tr>
        <th>SEEK_CUR</th>
        <td>Posición actual</td>
    </tr>
    <tr>
        <th>SEEK_END</th>
        <td>Fin del archivo</td>
    </tr>
</table>
</div>


<h2>DESPLAZAMIENTO</h2>

<pre class="line-numbers"><code class="language-c">long ftell(FILE *fp);</code></pre>
<p><b>fp:</b> archivo asociado</p>
<p>Devuelve la posición actual del archivo en bytes, si hubo error <b>-1L</b></p>

<h2>BORRAR UN ARCHIVO</h2>

<pre class="line-numbers"><code class="language-c">int remove(char *nombre);</code></pre>
<p><b>nombre:</b> unidad, ruta, nombre y extensión del archivo</p>
<p>Devuelve 0 si hubo éxito, si hubo error distinto de 0</p>



<h2>RETORNA AL COMIENZO</h2>

<pre class="line-numbers"><code class="language-c">void rewind(FILE *fp);</code></pre>
<p><b>fp:</b> archivo asociado</p>

<h2>LIBERAR EL BUFFER</h2>

<pre class="line-numbers"><code class="language-c">int fflush(FILE *fp);</code></pre>
<p><b>fp:</b> archivo asociado</p>
<p>Devuelve 0 si hubo exito, si hubo error <b>EOF</b></p>



<h2>ESTRUCTURA FILE</h2>

<div class="tablecontainer">
<table>
    <tr>
        <th>short level</th>
        <td>indica que tan vacío o lleno esta el buffer</td>
    </tr>
    <tr>
        <th>unsigned flags</th>
        <td>banderas de estatus del archivo</td>
    </tr>
    <tr>
        <th>char fd</th>
        <td>descriptor del archivo</td>
    </tr>
    <tr>
        <th>unsigned char hold</th>
        <td>ultimo carácter leído en el buffer para utilizar ungetc</td>
    </tr>
    <tr>
        <th>short bsize</th>
        <td>tamaño del buffer</td>
    </tr>
    <tr>
        <th>unsigned char *buffer</th>
        <td>buffer de transferencia de los datos</td>
    </tr>
    <tr>
        <th>unsigned char *curp</th>
        <td>posición actual del cursor del archivo</td>
    </tr>
    <tr>
        <th>unsigned istemp</th>
        <td>indicador de archivo temporal</td>
    </tr>
    <tr>
        <th>short token</th>
        <td>usado para chequeos de validación</td>
    </tr>
</table>
</div>

<script src="js/prism.js"></script>

<footer class="footer-nav">
  <a href="union.html" class="btn">Anterior</a>
  <a href="memoria.html" class="btn">Siguiente</a>
</footer>

</body>
</html>